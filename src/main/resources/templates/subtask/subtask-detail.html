<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>SubTask Detail</title>
</head>
<body>
<h1>Detaljer for subtask</h1>

<!-- Fejl- og succesbesked -->
<section th:if="${error}" class="error-section">
    <p th:text="${error}" class="error-message"></p>
</section>
<section th:if="${success}" class="success-section">
    <p th:text="${success}" class="success-message"></p>
</section>

<!-- Detaljer -->
<section class="details-grid">
    <div>Navn: <span th:text="${subtask.name}"></span></div>
    <div>Beskrivelse: <span th:text="${subtask.description}"></span></div>
    <div>Deadline: <span th:text="${subtask.deadline}"></span></div>
    <div>Estimeret tid: <span th:text="${subtask.estimatedTime}"></span> timer</div>
    <div>Aktuelle tidsforbrug: <span th:text="${subtask.timeSpent}"></span> timer</div>
    <div>Status: <span th:text="${subtask.status}"></span></div>
</section>

<!-- Rediger-knap for ADMIN og PROJECT_MANAGER -->
<section class="form-actions">
    <div>
        <a th:href="@{/subtasks/edit/{id}(id=${subtask.subTaskId})}">
            <button>Rediger subtask</button>
        </a>
    </div>
</section>

<!-- Vis tilknyttet bruger -->
<section class="mini-info">
    <h2>Tildelt bruger</h2>
    <p th:if="${assignedUser != null}">
        <span th:text="${assignedUser.firstName + ' ' + assignedUser.lastName + ' (' + assignedUser.role + ')'}"></span>
    </p>
    <p th:if="${assignedUser == null}">
        Ingen bruger er endnu tildelt denne underopgave.
    </p>
</section>

<!-- Formularer til tildeling af bruger -->
<section class="form-actions">
    <h2>Tildel mig selv</h2>
    <form th:action="@{'/subtasks/' + ${subtask.subTaskId} + '/assignme'}" method="post">
        <button type="submit">Tildel mig</button>
    </form>
</section>

<section class="form-actions">
    <h2>Tildel en anden bruger</h2>
    <form th:action="@{'/subtasks/' + ${subtask.subTaskId} + '/assign'}" method="post">
        <div>
            <label for="userId">VÃ¦lg bruger:</label>
            <select name="userId" id="userId">
                <option th:each="user : ${allUserList}"
                        th:value="${user.userId}"
                        th:text="${user.firstName + ' ' + user.lastName + ' (' + user.role + ')'}">
                </option>
            </select>
        </div>
        <div>
            <button type="submit">Tildel</button>
        </div>
    </form>
</section>

<!-- Navigation -->
<section class="navigation">
    <div>
        <a th:href="@{/subtasks}">
            <button>Tilbage til underopgaveliste</button>
        </a>
    </div>
    <div>
        <a th:href="@{/users/profile}">
            <button>Tilbage til forside</button>
        </a>
    </div>
</section>

</body>
</html>